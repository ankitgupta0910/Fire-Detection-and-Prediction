"use strict";var __awaiter=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(a,s){function i(e){try{u(r.next(e))}catch(e){s(e)}}function o(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(i,o)}u((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(a)throw new TypeError("Generator is already executing.");for(;o;)try{if(a=1,s&&(i=s[2&n[0]?"return":n[0]?"throw":"next"])&&!(i=i.call(s,n[1])).done)return i;switch(s=0,i&&(n=[0,i.value]),n[0]){case 0:case 1:i=n;break;case 4:return o.label++,{value:n[1],done:!1};case 5:o.label++,s=n[1],n=[0];continue;case 7:n=o.ops.pop(),o.trys.pop();continue;default:if(i=o.trys,!(i=i.length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){o=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){o.label=n[1];break}if(6===n[0]&&o.label<i[1]){o.label=i[1],i=n;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(n);break}i[2]&&o.ops.pop(),o.trys.pop();continue}n=t.call(e,o)}catch(e){n=[6,e],s=0}finally{a=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var a,s,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return{next:n(0),throw:n(1),return:n(2)}};Object.defineProperty(exports,"__esModule",{value:!0});var es6OAssign=require("es6-object-assign"),assign=es6OAssign.assign,validated_request_1=require("validated-request"),converter_1=require("./converter"),RSSCleanup=function(){function e(){this.validatedRequest=new validated_request_1.ValidatedRequest([{headers:{"Content-Type":"string",accept:"string","user-agent":"string"},method:"GET"}])}return e.staticParse=function(t){var n=new e;return n.parse(t)},e.prototype.parse=function(e){return __awaiter(this,void 0,void 0,function(){var t,n,r,a,s,i,o,u,c;return __generator(this,function(l){switch(l.label){case 0:return t={"Content-Type":"application/json",accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8","user-agent":"rss-cleanup"},[4,this.validatedRequest.get(e,t)];case 1:return n=l.sent(),r=n.response,a=n.body,[4,converter_1.xmlToJson(a)];case 2:return s=l.sent(),[4,converter_1.extractChannel(s)];case 3:return i=l.sent(),[4,converter_1.extractHeaders(i)];case 4:return o=l.sent(),[4,converter_1.extractRawItems(i)];case 5:return u=l.sent(),[4,converter_1.extractCleanItems(u)];case 6:return c=l.sent(),[2,assign({},o,{entries:c})]}})})},e}();exports.RSSCleanup=RSSCleanup;