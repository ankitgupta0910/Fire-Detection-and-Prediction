<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <link rel="icon" type="image/png" href="./img/favicon.ico">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

  <title>Forest Fire Analysis and Prediction</title>

  <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
  <meta name="viewport" content="width=device-width" />

  <!-- Angular     -->
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.6/angular.min.js"></script>

  <!-- Bootstrap core CSS     -->
  <link href="./stylesheets/bootstrap.min.css" rel="stylesheet" />

  <!-- Animation library for notifications   -->
  <link href="./stylesheets/animate.min.css" rel="stylesheet"/>
  <link href="./stylesheets/zoomPan.css" rel="stylesheet"/>
  <!--  Light Bootstrap Table core CSS    -->
  <link href="./stylesheets/light-bootstrap-dashboard.css" rel="stylesheet"/>


  <!--  CSS for Demo Purpose, don't include it in your project     -->
  <link href="./stylesheets/demo.css" rel="stylesheet" />


  <!--     Fonts and icons     -->
  <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
  <link href='http://fonts.googleapis.com/css?family=Roboto:400,700,300' rel='stylesheet' type='text/css'>
  <link href="./stylesheets/pe-icon-7-stroke.css" rel="stylesheet" />

</head>
<body ng-app="CMPE295B" data-ng-controller="cmpe295B">

<div class="wrapper">
  <div class="sidebar" data-color="purple" data-image="./img/sidebar-5.jpg">

    <!--

        Tip 1: you can change the color of the sidebar using: data-color="blue | azure | green | orange | red | purple"
        Tip 2: you can also add an image using data-image tag

    -->

    <div class="sidebar-wrapper">
      <div class="logo">
        <a href="" class="simple-text">
          Forest Fire Pro
        </a>
      </div>

      <ul class="nav">
        <li>
          <a href="dashboard.html">
            <i class="pe-7s-graph"></i>
            <p>Dashboard</p>
          </a>
        </li>
        <li>
          <a href="user.html">
            <i class="pe-7s-user"></i>
            <p>User Profile</p>
          </a>
        </li>
        <li>
          <a href="table.html">
            <i class="pe-7s-note2"></i>
            <p>Satellite Data</p>
          </a>
        </li>
        <li class="active">
          <a href="typography.html">
            <i class="pe-7s-news-paper"></i>
            <p>Fire Detection</p>
          </a>
        </li>
        <li>
          <a  href=# ng-click="pred()">
            <i class="pe-7s-science"></i>
            <p>Fire Prediction</p>
          </a>
        </li>
        <li>
          <a href=# ng-click="map()">
            <i class="pe-7s-map-marker"></i>
            <p>Maps</p>
          </a>
        </li>
        <li>
          <a href="firefighters.html">
            <i class="pe-7s-medal"></i>
            <p>Fire Fighters</p>
          </a>
        </li>

        <li>
          <a href="notifications.html">
            <i class="pe-7s-bell"></i>
            <p>Notifications</p>
          </a>
        </li>
      </ul>
    </div>
  </div>

  <div class="main-panel">
    <nav class="navbar navbar-default navbar-fixed">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navigation-example-2">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Dashboard</a>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav navbar-left">
            <li>
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                <i class="fa fa-dashboard"></i>
              </a>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                <i class="fa fa-globe"></i>
                <b class="caret"></b>
                <span class="notification">5</span>
              </a>
              <ul class="dropdown-menu">
                <li><a href="#">Notification 1</a></li>
                <li><a href="#">Notification 2</a></li>
                <li><a href="#">Notification 3</a></li>
                <li><a href="#">Notification 4</a></li>
                <li><a href="#">Another notification</a></li>
              </ul>
            </li>
            <li>
              <a href="">
                <i class="fa fa-search"></i>
              </a>
            </li>
          </ul>

          <ul class="nav navbar-nav navbar-right">
            <li>
              <a href="">
                Account
              </a>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Dropdown
                <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                <li><a href="#">Action</a></li>
                <li><a href="#">Another action</a></li>
                <li><a href="#">Something</a></li>
                <li><a href="#">Another action</a></li>
                <li><a href="#">Something</a></li>
                <li class="divider"></li>
                <li><a href="#">Separated link</a></li>
              </ul>
            </li>
            <li>
              <a href="#">
                Log out
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="content">
      <div class="container-fluid">
        <div class="row">
          <div class="col-md-9">
            <div class="card tile">
              <!--<img src="/images/<%= result %>" style="height:500px;width:715px" ng-mousemove="trackMouse($event)"></img>-->
              <zoom src="{{ '/images/<%= result %>' }}"  frame="example1" img="image1" zoomlvl="1.5")></zoom>
            </div>
          </div>

          <div class="col-md-3">
            <div class="card">
              <div class="header">
                <h4 class="title"><%= detail %></h4>
                <!--<input type="hidden" name="qdate" ng-value="qdate" ng-init=<%= qdate %> />-->
                <p class="category">The color of smoke is greyish blue and it is very dense.</p>
              </div>
            <div class="content">
              <!--<div id="chartPreferences" class="ct-chart ct-perfect-fourth"></div>-->

              <div class="footer">
                <div class="legend">
                  <i class="fa fa-circle text-info"></i> Mitigated
                  <i class="fa fa-circle text-danger"></i> Active
                  <i class="fa fa-circle text-warning"></i> Highly Active
                </div>
                <hr>
                <div class="stats">
                  <i class="fa fa-clock-o"></i> Campaign sent 2 days ago
                </div>
              </div>
            </div>
          </div>
          </div>
        </div>
        </div>


  <div>
    <table class="table table-bordered">
      <!--<tr>-->
        <!--<th ng-repeat="(key, val) in items[0]">{{key}}</th>-->
        <thead>
        <tr>
          <th>Time <span class="nb">(PDT)</span></th>
          <th>Temp</th>
          <th>Dew Point</th>
          <th>Humidity</th>
          <th>Pressure</th>
          <th>Visibility</th>
          <th>Wind Dir</th>
          <th>Wind Speed</th>
          <th>Gust Speed</th>
          <th>Precip</th>
          <th>Conditions</th>
        </tr>
        </thead>
      <!--</tr>-->
      <tr ng-repeat="item in weather">
        <td ng-repeat="(key, val) in item">{{val}}</td>
      </tr>
      </table>
  </div>
    </div>

    <footer class="footer">
      <div class="container-fluid">
        <nav class="pull-left">
          <ul>
            <li>
              <a href="#">
                Home
              </a>
            </li>
            <li>
              <a href="#">
                Company
              </a>
            </li>
            <li>
              <a href="#">
                Portfolio
              </a>
            </li>
            <li>
              <a href="#">
                Blog
              </a>
            </li>
          </ul>
        </nav>
        <p class="copyright pull-right">
          &copy; 2017 <a href="">Forest Fire Pro</a>, a boon for Fire Fighters.
        </p>
      </div>
    </footer>

  </div>
</div>


</body>

<!--   Core JS Files   -->
<!--<script src="./javascripts/jquery-1.10.2.js" type="text/javascript"></script>-->
<script
src="https://code.jquery.com/jquery-3.1.1.js"
integrity="sha256-16cdPddA6VdVInumRGo6IbivbERE8p7CQR3HzTBuELA="
crossorigin="anonymous"></script>
<script
src="./javascripts/bootstrap.min.js" type="text/javascript"></script>

<!--  Checkbox, Radio & Switch Plugins -->
<script src="./javascripts/bootstrap-checkbox-radio-switch.js"></script>

<!--  Charts Plugin -->
<script src="./javascripts/chartist.min.js"></script>

<!--  Notifications Plugin    -->
<script src="./javascripts/bootstrap-notify.js"></script>

<!--  Google Maps Plugin    -->
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>

<!-- Light Bootstrap Table Core javascript and methods for Demo purpose -->
<script src="./javascripts/light-bootstrap-dashboard.js"></script>

<!-- Light Bootstrap Table DEMO methods, don't include it in your project! -->
<script src="./javascripts/demo.js"></script>

<script type="text/javascript">
    $(document).ready(function(){

        demo.initChartist();

        $.notify({
            icon: 'pe-7s-gift',
            message: "Welcome to <b>Fire Prediction and Analysis</b> - a boon for Fire Fighters."

        },{
            type: 'info',
            timer: 4000
        });

    });

    var app = angular.module('CMPE295B', []);

    app.controller('cmpe295B', function ($scope,$http,$window,$filter)
    {

        alert(<%= qdate %>);
        alert("<%= detail %>");
        $scope.map = function()
        {
            $window.location.href = '/maps';
        }

        $scope.pred = function()
        {
            $http({
                method: 'POST',
                url: '/fire_prediction',
                data: {"temp":$scope.temp, "humi":$scope.humi, "wisp":$scope.wisp, "name" : "<%= detail %>"}
            }).then(function(response){
//            $window.location.href = '/fire_prediction?var=' + $scope.temp + '&var1=' + $scope.humi;
              alert("Hello World!!");
        			});
    }

        $http({
            method: 'GET',
            url: 'http://api.wunderground.com/api/e543fd122f652dfc/history_' + <%= qdate %> + '/q/CA/San_Francisco.json'

        }). then(function(response) {
            alert("Ankit");
            $scope.weather = [];
            $scope.temp = [];
            $scope.humi = [];
            $scope.wisp = [];
            for (var i = 0; i < Object.keys(response['data']['history']['observations']).length - 1; i++) {
                $scope.temp.push((Math.floor(response['data']['history']['observations'][i]['tempi'])).toString());
                $scope.humi.push((response['data']['history']['observations'][i]['hum']).toString());
                $scope.wisp.push((response['data']['history']['observations'][i]['wspdi']).toString());
                var myObj = {
                    "date" : response['data']['history']['observations'][i]['date']['pretty'],
                    "tempi" : Math.floor(response['data']['history']['observations'][i]['tempi']),
                    "dewpti" : response['data']['history']['observations'][i]['dewpti'],
                    "hum" : response['data']['history']['observations'][i]['hum'],
                    "pressurei" : response['data']['history']['observations'][i]['pressurei'],
                    "visi" : response['data']['history']['observations'][i]['visi'],
                    "wdire" : response['data']['history']['observations'][i]['wdire'],
                    "wspdi" : response['data']['history']['observations'][i]['wspdi'],
                    "wgusti" : response['data']['history']['observations'][i]['wgusti'],
                    "precipi" : response['data']['history']['observations'][i]['precipi'],
                    "conds" : response['data']['history']['observations'][i]['conds']
                }
                $scope.weather.push(myObj);
            }

            alert($scope.temp);
            alert($scope.humi);
        });
    });

    app.directive('zoom', function($window) {

        function link(scope, element, attrs) {

            //SETUP

            var frame, image, zoomlvl, fWidth, fHeight, rect, rootDoc, offsetL, offsetT, xPosition, yPosition, pan;
            //Template has loaded, grab elements.
            scope.$watch('$viewContentLoaded', function()
            {
                frame = angular.element(document.querySelector("#"+scope.frame))[0];
                image = angular.element(document.querySelector("#"+scope.img))[0];

                zoomlvl = (scope.zoomlvl === undefined) ? "2.5" : scope.zoomlvl
            });



            //MOUSE TRACKER OVER IMG
            scope.trackMouse = function($event) {

                fWidth = frame.clientWidth;
                fHeight = frame.clientHeight;

                rect = frame.getBoundingClientRect();
                rootDoc = frame.ownerDocument.documentElement;

                //calculate the offset of the frame from the top and left of the document
                offsetT = rect.top + $window.pageYOffset - rootDoc.clientTop
                offsetL = rect.left + $window.pageXOffset - rootDoc.clientLeft

                //calculate current cursor position inside the frame, as a percentage
                xPosition = (($event.pageX - offsetL) / fWidth) * 100
                yPosition = (($event.pageY - offsetT) / fHeight) * 100

                pan = xPosition + "% " + yPosition + "% 0";
                image.style.transformOrigin = pan;

            }

            //MOUSE OVER | ZOOM-IN
            element.on('mouseover', function(event) {
                image.style.transform = 'scale('+zoomlvl+')'
            })

            //MOUSE OUT | ZOOM-OUT
            element.on('mouseout', function(event) {
                image.style.transform = 'scale(1)'
            })


        }

        return {
            restrict: 'EA',
            scope: {
                src: '@src',
                frame: '@frame',
                img: '@img',
                zoomlvl: '@zoomlvl'
            },
            template: [
                '<div id="{{ frame }}" class="zoomPanFrame" >',
                '<img id="{{ img }}" class="zoomPanImage" ng-src= "{{ src }}" ng-mousemove="trackMouse($event)"></img>',
                '</div>'
            ].join(''),
            link: link
        };
    });

</script>

</html>
